<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<style>
    .pace .pace-progress {
        background: #1E92FB; /*进度条颜色*/
        height: 2px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*上边框颜色*/
        border-left-color: #1E92FB;    /*左边框颜色*/
    }
</style>
<meta name="theme-color" content="#222">






  
  
  <link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3">




<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="CCD," />










<meta name="description" content="CCD知识点像素 pixel and 分辨率 resolutionAn actual CCD will consist of a large number of pixels (i.e, potential wells), arranged horizontally in rows and vertically in columns。For example,1024 x 1024,each pix">
<meta name="keywords" content="CCD">
<meta property="og:type" content="article">
<meta property="og:title" content="CCD知识点">
<meta property="og:url" content="http://yoursite.com/2017/07/10/CCD知识点/index.html">
<meta property="og:site_name" content="BQGao的博客">
<meta property="og:description" content="CCD知识点像素 pixel and 分辨率 resolutionAn actual CCD will consist of a large number of pixels (i.e, potential wells), arranged horizontally in rows and vertically in columns。For example,1024 x 1024,each pix">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-12-21T05:27:52.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CCD知识点">
<meta name="twitter:description" content="CCD知识点像素 pixel and 分辨率 resolutionAn actual CCD will consist of a large number of pixels (i.e, potential wells), arranged horizontally in rows and vertically in columns。For example,1024 x 1024,each pix">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.3',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/07/10/CCD知识点/"/>





  <title>CCD知识点 | BQGao的博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>

    <a href="https://github.com/bqgao" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">BQGao的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-travel">
          <a href="/travel" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-plane"></i> <br />
            
            旅游
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
    
    <div class="post-block page">
      <header class="post-header">

	<h1 class="post-title" itemprop="name headline">CCD知识点</h1>



</header>

      
      
      
      <div class="post-body han-init-context">
        
        
          <h1 id="CCD知识点"><a href="#CCD知识点" class="headerlink" title="CCD知识点"></a>CCD知识点</h1><h2 id="像素-pixel-and-分辨率-resolution"><a href="#像素-pixel-and-分辨率-resolution" class="headerlink" title="像素 pixel and 分辨率 resolution"></a>像素 pixel and 分辨率 resolution</h2><p>An actual CCD will consist of a large number of pixels (i.e, potential wells), arranged horizontally in rows and vertically in columns。For example,1024 x 1024,<br>each pixel is 10$um$,</p>
<h2 id="charge"><a href="#charge" class="headerlink" title="charge"></a>charge</h2><p>将光子转换为电子信号，The CCD is an analogue device, and the analogue voltage values are converted into a digital form by the camera electronics.</p>
<h2 id="degree-arcseconds-arcmin"><a href="#degree-arcseconds-arcmin" class="headerlink" title="degree arcseconds arcmin"></a>degree arcseconds arcmin</h2><p>arcseconds = (206.265 / (focal length in mm) ) x (pixel size in microns)<br>**arcmin is a unit of angular measurement equal to 1/60 of one degree,also equal to $\frac{\pi}{10800}$ radian. arcseconds is equal to $\frac{1}{60}$ of arcmin, so one degreen is 3600 arcseconds.</p>
<h2 id="Some-aspects-of-CCD-behaviour"><a href="#Some-aspects-of-CCD-behaviour" class="headerlink" title="Some aspects of CCD behaviour"></a>Some aspects of CCD behaviour</h2><h3 id="Quantum-Efficiency"><a href="#Quantum-Efficiency" class="headerlink" title="Quantum Efficiency"></a>Quantum Efficiency</h3><p>并不是每一个电子都会被探测器探测到并转换为脉冲信号，The percentage of photons that are actually detected is known as the Quantum Efficiency (QE).</p>
<h3 id="Wavelength-range"><a href="#Wavelength-range" class="headerlink" title="Wavelength range"></a>Wavelength range</h3><p>CCDs can have a wide wavelength range ranging from about 400nm (blue) to about 1050nm (Infra-red) with a peak sensitivity at around 700nm</p>
<h3 id="Dynamic-Range"><a href="#Dynamic-Range" class="headerlink" title="Dynamic Range"></a>Dynamic Range</h3><p>在同一幅图上可以准确分别的最亮源和最暗源的能力。the dynamic range of a CCD is usually discussed in terms of the minimum and maximum number of electrons that can be imaged。当更多的光线落入到 CCD 上时，越来越多的光子被填充进势阱，最终到势阱无法容纳电子，像素饱和。<strong>读出噪声：每个像素中的最小光子数（信号）</strong></p>
<h3 id="Linearity"><a href="#Linearity" class="headerlink" title="Linearity"></a>Linearity</h3><p>the eye is not a linear detector (except over very small variations in intensity) and has a logarithmic response.探测到的光子与转换为的电子是线性关系的。</p>
<h3 id="Noise"><a href="#Noise" class="headerlink" title="Noise"></a>Noise</h3><p>One of the most important aspects of CCD performance is its noise response.</p>
<ol>
<li>Dark current—thermally generated nois:At room temperature, the noise performance of a CCD can be as much as thousands of electrons per pixel per second.在冷却效果下，暗电流会急速的降低，实际观测中会对 CCD 进行降温。降为多少度才是合理的？</li>
<li>readnoise—the ultimate noise limit of the CCD:he readout noise originates from the conversion of the electrons in each pixel to a voltage on the CCD output node (a typical value would be around 4µV per electron).Noise values of 2-3 electrons rms (root mean square) are now typical for many CCDs</li>
<li>SNR(Signal divide Noise) 越大，目标被探测的概率越大</li>
</ol>
<h3 id="full-well-capacity-FWC"><a href="#full-well-capacity-FWC" class="headerlink" title="full-well capacity (FWC)"></a>full-well capacity (FWC)</h3><p>full-well capacity (FWC) determines the maximum signal that can be sensed in the pixel, and is a primary factor affecting the CCD’s dynamic range.<br>The above image has an average background sky pixel value of 950.  Most software packages add a pedestal value of 100 to the pixel values in order to prevent negative numbers.  This means the true value is 850.  This is called the Background ADU Count.  To convert to a value in electrons, this number must be multiplied by the camera gain.  In this example, an ST-10XME camera was used, which has a gain of 1.3e-/ADU.  Therefore the actual sky background value is 1105e-.  The exposure was 600 seconds, implying a sky background flux at this observing location of 1.8e-/sec, indicating a dark site.  Again this is a function of the focal ratio, in this case f/7.</p>
<h3 id="System-Gain-G"><a href="#System-Gain-G" class="headerlink" title="System Gain (G)"></a>System Gain (G)</h3><p>一个 CCD 数模转换单元(ADU)对应的原始光生电子数，单位为$e^{-} / ADU$，比如$1.8 e^{-} / ADU$表示每1.8个电子产生相机的一个技术单位。<strong>单位时间内入射的光子数可以用泊松分布来表示</strong>，</p>
<h2 id="CCD-Format"><a href="#CCD-Format" class="headerlink" title="CCD Format"></a>CCD Format</h2><h3 id="analog-to-digital-converter-ADC-and-analog-to-digital-unit-ADU"><a href="#analog-to-digital-converter-ADC-and-analog-to-digital-unit-ADU" class="headerlink" title="analog-to-digital converter (ADC) and analog-to-digital unit (ADU)"></a>analog-to-digital converter (ADC) and analog-to-digital unit (ADU)</h3><p>After the output amplifier fulfills its function of magnifying a charge packet and converting it to a proportional voltage, the signal is transmitted to an analog-to-digital converter (ADC).an ADC capable of 12-bit resolution assigns each pixel a value ranging from 0 to 4095, representing 4096 possible image gray levels (2 to the 12th power is equal to 4096 digitizer steps). Each gray-level step is termed an analog-to-digital unit (ADU).</p>
<h3 id="image-quality"><a href="#image-quality" class="headerlink" title="image quality"></a>image quality</h3><ol>
<li><strong>Spatial Resolution</strong>: Determines the ability to capture fine specimen details without pixels being visible in the image.</li>
<li><strong>Light-Intensity Resolution</strong>: Defines the dynamic range or number of gray levels that are distinguishable in the displayed image.</li>
<li><strong>Time Resolution</strong>: The sampling (frame) rate determines the ability to follow live specimen movement or rapid kinetic processes.</li>
<li><strong>Signal-to-Noise Ratio</strong>: Determines the visibility and clarity of specimen signals relative to the image background.</li>
</ol>
<h2 id="图像矫正"><a href="#图像矫正" class="headerlink" title="图像矫正"></a>图像矫正</h2><h3 id="暗电流矫正-Dark-current"><a href="#暗电流矫正-Dark-current" class="headerlink" title="暗电流矫正(Dark current)"></a>暗电流矫正(Dark current)</h3><p>CCD 通电产生的温度带来的噪声，实际中一般降低温度冷却即可。在无光的环境下以相同的温度与曝光时间再次拍摄CCD影像，所得到的就是纯粹由CCD温度所产生的杂讯，所以这样的校正影像也称为暗电流影像（dark current frame )。</p>
<h3 id="偏压矫正-bias"><a href="#偏压矫正-bias" class="headerlink" title="偏压矫正(bias )"></a>偏压矫正(bias )</h3><p>一般天文CCD晶片上有数百万个像素，每个像素的特性皆不同，有些在未拍摄的状态下也会有少许的电子信号产生，有些则是曝光结束后，在从CCD晶片读出影像的过程中，每个像素的影像信号依序传输时所产生的杂讯，这些杂讯同样会加入拍摄的天体影像中，需要加以排除。这种校正影像称为BIAS（偏压杂讯）。因为BIAS是像素本身以及信号传递过程所产生的不必要讯号，与拍摄时间无关，所以其实偏压杂讯影像就是拍摄0秒钟的暗电流影像。<strong>本底图像一般是采用零秒暗场图像</strong></p>
<h3 id="平场矫正-flat-field"><a href="#平场矫正-flat-field" class="headerlink" title="平场矫正(flat field)"></a>平场矫正(flat field)</h3><p>光线从望远镜前方进入一直到被CCD的像素感应之前，至少会经过望远镜的镜片或玻璃、滤镜、CCD前方的保护玻璃等等，每个光线经过的地方如果有灰尘或污渍，或是透光率不同，就会造成到达像素的光线不均匀。</p>
<p>此外，望远镜虽然可以将光线集中聚焦，但是光线出口处的中央最亮，越旁边光线越弱，称为周边减光效应。如果不做校正，将会出现星星在CCD的位置不同，其亮度就不同的错误。解决方式就是将整个光学系统对向均匀的光线来源拍摄影像，即可知道光量不均的状况。这样的校正影像称为平场影像（Flat Field image）</p>
<h3 id="Overscan-区域"><a href="#Overscan-区域" class="headerlink" title="Overscan 区域"></a>Overscan 区域</h3><p>在一些 CCD 中有一些不感光的行与列，或者在 CCD 每行读出前后，空读出若干行和列。</p>
<h2 id="利用-CCD-进行天文观测的策略"><a href="#利用-CCD-进行天文观测的策略" class="headerlink" title="利用 CCD 进行天文观测的策略"></a>利用 CCD 进行天文观测的策略</h2><h3 id="基本原理"><a href="#基本原理" class="headerlink" title="基本原理"></a>基本原理</h3><p>改正图像 = $\frac{观测图像-本底图像-暗场}{平场图像-本底图像-暗场}$.</p>
<h3 id="观测前准备"><a href="#观测前准备" class="headerlink" title="观测前准备"></a>观测前准备</h3><ol>
<li>熟悉所用望远镜观测系统和控制界面</li>
<li>确认当晚要用的滤光片</li>
<li>准备原表和标准星表，证认图，观测顺序，曝光时间</li>
<li>准备候选源表，如果天气条件不好时观测</li>
</ol>
<h3 id="观测策略"><a href="#观测策略" class="headerlink" title="观测策略"></a>观测策略</h3><ol>
<li>成像观测<ul>
<li>选择所用滤光片</li>
<li>5-10幅本底图像</li>
<li>5-10幅平场图像</li>
<li>获取标准星图像</li>
<li>目标源图像</li>
<li>观测顺序：天文昏影终之前：本底图像—-平场图像—标准星–目标源—标准星—目标源…….天文晨光始：平场图像—本底图像</li>
</ul>
</li>
<li><p>光谱观测<br> 根据所需分辨率和观测当晚的 seeing 选择缝宽，获取本底图像、所用色散元件的光谱色散平场图像，所 用色散元件的波长定标谱，所用色散元件的标准星谱</p>
<h3 id="本底图像-BIAS"><a href="#本底图像-BIAS" class="headerlink" title="本底图像(BIAS)"></a>本底图像(BIAS)</h3><p> 每天在开始观测前和结束观测前各获取5-10幅<strong>0秒暗场</strong>，要求<strong>快门关闭、圆顶关闭和关灯、望远镜镜盖关闭</strong></p>
<h3 id="平场-Flat-Field"><a href="#平场-Flat-Field" class="headerlink" title="平场(Flat-Field)"></a>平场(Flat-Field)</h3><p> 每天观测开始前和结束后各获取5-10幅，三类平场</p>
<ul>
<li>圆顶灯光平场(Dome-Flat):优点是不依赖天气、不占观测时间、高光子计数；缺点是照明很难均匀、光谱源与夜天光差别很大</li>
<li>晨昏天光平场(Twilight-Flat)：优点是在一定视场内比较均匀、不占观测时间、高计数；缺点是大视场不均匀、每天观测时间短、可能亮源污染、光谱不同于夜天光</li>
<li><p>夜天光平场(Super-sky-Flat)–通过图像合并技术实现：优点是均匀、与观测条件完全相同；缺点是占观测时间、依赖天气、低计数</p>
<h3 id="目标源"><a href="#目标源" class="headerlink" title="目标源"></a>目标源</h3><p>观测策略：最好在目标源中天时观测（大气消光最小），先用 CCD 快模式获取快照，检查视场然后用 CCD 慢模式观测；长曝光最好采用2-3次曝光方式，甚至采用 dithering 方式观测。</p>
<h2 id="数据处理"><a href="#数据处理" class="headerlink" title="数据处理"></a>数据处理</h2><h3 id="基本原理-1"><a href="#基本原理-1" class="headerlink" title="基本原理"></a>基本原理</h3><p>$改正图像 = \frac{源图像-本底图像}{平场图像-本底图像}$</p>
<h3 id="成像"><a href="#成像" class="headerlink" title="成像"></a>成像</h3></li>
<li><p>基本 CCD 处理</p>
</li>
<li>测光</li>
<li><p>流量标定</p>
<h3 id="光谱"><a href="#光谱" class="headerlink" title="光谱"></a>光谱</h3></li>
</ul>
<ol>
<li>基本 CCD 处理</li>
<li>波长标定</li>
<li>弯曲改正</li>
<li>抽谱</li>
<li><p>流量定标</p>
<h3 id="误差"><a href="#误差" class="headerlink" title="误差"></a>误差</h3></li>
<li><p>随机误差—符合高斯分布<br>可以通过数据统计得到<br>误差源：</p>
<ul>
<li>CCD 读出噪声</li>
<li>扣除 overscan 带来误差</li>
<li>减本底图像带来误差</li>
<li>平场改正带来误差</li>
<li>暗流改正带来误差</li>
<li>天光背景噪声</li>
<li>去除背景误差<br>随机误差可以通过下面公式累加:$\sigma^2 = \sigma_1^2 + \sigma_2^2 + …$</li>
</ul>
<ol>
<li><p>系统误差<br>难以测量</p>
<h3 id="CCD-增益和读出噪声计算"><a href="#CCD-增益和读出噪声计算" class="headerlink" title="CCD 增益和读出噪声计算"></a>CCD 增益和读出噪声计算</h3><p>CCD 相机的2个基本量：读出噪声–单位电子/像素、增益–电子/ADU计数。简易计算：</p>
<ol>
<li>基本假设：CCD 在小范围内不同像素的性质一样</li>
<li>获取2幅同样条件下的平场图像（F1,F2）</li>
<li>获取2幅本底图像(B1,B2)</li>
<li>图像运算：B12 = B1-B2;F12 = F1-F2</li>
</ol>
</li>
</ol>
<h2 id="图像合并"><a href="#图像合并" class="headerlink" title="图像合并"></a>图像合并</h2></li>
<li><p>增加信噪比</p>
</li>
<li>去除宇宙线</li>
<li>去除坏像元</li>
<li>提高空间分辨率</li>
<li>加大读出噪声</li>
</ol>
<ul>
<li><strong>图像合并原理</strong>：对于每个图像对应点有值$a_1$,$a_2$,…,$a_n$，算法：1. 简单求和$S = a_1 + a_2 + … + a_n$。2. 平均值：S/n。3. 中值：$a_m$。4. mode法：$3\times mean - 2\times median$。5. $3\sigma clip$法：去除偏离平均值$3\sigma$以外的点。6. Minmax：剔除若干大值和小值后平均.7. 最可几值</li>
<li>每一副图像扣除背景图像</li>
<li><p>由于每一副图星象位置不一样，需要把每幅图同一颗星的位置测出，用来计算位置偏差。</p>
<h2 id="图像处理流程详细知识"><a href="#图像处理流程详细知识" class="headerlink" title="图像处理流程详细知识"></a>图像处理流程详细知识</h2><h3 id="天光背景知识与提取-SEXtractor"><a href="#天光背景知识与提取-SEXtractor" class="headerlink" title="天光背景知识与提取 SEXtractor"></a>天光背景知识与提取 SEXtractor</h3><p>巡天图像中的每一个像素的光子是背景信号和目标源信号的累积，需要构造天光背景分布情况，使用的是$K-\sigma clipping$算法，将图像分解为若干个局部区域，在一个局部区域计算所以像素的平均值(mean)、中值(median)、标准差（$\sigma$）。去除落在 median $\pm 3\sigma$外的像素值，迭代直到所有像素都在median $\pm 3\sigma$内，如果每次迭代后的$\sigma$相对上次的变换小于20%，此区域内背景值直接用最后的平均值代替，如果大于20%，此区域内的背景值用众数mode 代替:$mode = 3median - 2 mean$,另外，也可以用$mode = 2.5 median - 1.5mean$，在密集情况下效果更佳，但带来更大的噪声。<strong>对得到的背景值随区域位置的分布进行中值滤波平滑得到全图像区域的天光背景图像，BACK_FILTERSIZE</strong>，每个小区域面积（像素数量）等于输入的参数BACK_SIZEHI值</p>
<h3 id="目标源的检测"><a href="#目标源的检测" class="headerlink" title="目标源的检测"></a>目标源的检测</h3></li>
</ul>
<ol>
<li>峰值检测：适用于恒星检测，不适用于地面度亮源的检测</li>
<li>阈值检测：有参数DETECT_MINAREA、 DETECT_THRESH 和ANALYSIS_THRESH 调节，参数DETECT_THRESH用于检测目标源的阈值，ANALYSIS_THRESH分析目标源和 FWHM 时用到的阈值，</li>
<li>天体轮廓被提取需要满足的三个条件：<ul>
<li>所以扣除背景后的像素值要高于设定的检测阈值</li>
<li>所有这些像素必须在一个连通区域内</li>
<li>这些像素的数量必须不少于设定的DETECT_MINAREA 的值</li>
</ul>
</li>
<li>通过对图像进行滤波减弱噪声对目标源检测的影响，用于暗弱天体检测的高斯掩码和地面度亮源的Top-Hat 掩码</li>
<li>多阈值算法：<strong>构建一组多等光度线来分析判断一个像素块是否包含了多个目标源的叠加，并且对有叠加的情况分解其中不同目标源的像素区域</strong>，由输入参数DEBLEND_NTHRESH 和DEBLEND_MINCONT调节，具体流程是：<ul>
<li>对每一个像素块在检测阈值和扣除背景后的峰值之间分成N 个水平，这 N 个水平构成一线性或指数数列，sextractor 在像素块内再作 N次阈值检测，其中第 i 次以$t_i$为阈值，每次检测得到一组或多组连通的像素小区，</li>
</ul>
</li>
</ol>
</li>
</ol>
<pre><code>## CCD 系统

  1. 像素数是行和列的像素数目，即行乘以列；像素大小就是一个像素的尺寸。像素数乘以像素大小是 CCD 的尺寸。
  2. 线性： $S_{out} = g S_{in} + S_0$,即输出数据为增益乘以输出光量加零点，其中零点是本底加暗流
  3. 动态范围：器件像素饱和时电荷与3倍系统噪声均方根之比
  4. 失效像素：像素光敏性很差或者根本没有光敏性、另外一些像素暗流特别大，无法正常工作，这些像素称为失效像素。
  5. 起晕：当 CCD 的某些像素受到极强光照射时，位阱收集的电荷已远远超过饱和值，使一部分电荷溢出到邻近像素，造成类似于照相底片上亮星周围的光晕。**为了提取暗天体，曝光时间总量尽量加长，是记录的暗星有较高的信噪比，同一区域内越来越多的亮星起晕，拖尾现象的处理需要了解下**
  6. 信噪比和极限星等的估计： **决定观测质量的好坏和最暗可观测天体星等的因素，归根到底，是图像的信噪比**，一个点源天体在焦面上占据nxn像素，设曝光时间为 t，单位时间内，nxn 像素接受到的总光子是 S，天光背景在每一个像素上累积的光子是 Bt，暗流电荷是 dt，CCD 系统的系统噪声为$N_r$,量子效应为 Q，则信号为 QSt，总噪声为 $N_{total} = \sqrt{QSt + n^2QBt+ n^2 dt + n^2 N_r^2}$。则信噪比为 $\sigma = \frac{QSt}{\sqrt{QSt + n^2QBt+ n^2 dt + n^2 N_r^2}}$。
  7. ADU： 经过模数变换器转换后的数字，**增益为一个电子对应的 ADU 数，计算增益值得方法是： $N_{out}^2 = g S_{out} + g^2 N_{r,in}^2$,改变入射光强度，得到一组$N_{out}^2,S_{out}$,他们具有线性关系，斜率为增益 g，截距为$g^2 N_{r,in}^2$,求出系统噪声$N_{r,in}$**。

## CCD 图像处理

 1. 预处理： 设有一帧 CCD 原始图像R(x,y) , x,y表示像素坐标。用同样曝光时间，但在全黑环境下拍摄的图像称为暗场d(x,y),将两图相减，即$S_1(x,y) = R(x,y)-d(x,y)$，$S_1(x,y)$即为去除个像素暗流的图像，消除像素灵敏度不同的影响，采用平场校正的办法，平场是在同样条件下，对均匀亮度的面光源取得一帧图像。**将拍摄的平场$F(x,y)$对$S_1(x,y)$按对应像素一一相除，就校正了灵敏度的差别，必须先对平场做暗场的处理，需要采用和平场曝光时间相同的暗场才有效**    
 2. 为了改善暗场与平场的信噪比，最好在短时期内用同样曝光时间摄取许多帧暗场和平场，分别加以平均，以提高图像的信噪比。
 3. 星等的测定
    * 星等的计算：CCD 图像上的星象，可提取的天文信息是恒星亮度和恒星的位置，测量恒星的星等就是测量该星覆盖范围内的总光量，减去相同面积内的天光总量。设总光量为$S_{s,sum(x,y)}$,则两星的星等差为$\frac{S_{s,sum }}{S_{s,sum2}} = 2.512^{m_2-m_1}$.
</code></pre>
        
      </div>
      
      
      
    </div>
    
    
    
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="BQGao" />
            
              <p class="site-author-name" itemprop="name">BQGao</p>
              <p class="site-description motion-element" itemprop="description">做着科研搞 IT,踏着旅途玩摄影,看书喝茶撩撩妹</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/bqgao" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:gaobaoquan0406@gmail.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.zhihu.com/people/BQGao" target="_blank" title="Zhihu">
                    
                      <i class="fa fa-fw fa-globe"></i>Zhihu</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#CCD知识点"><span class="nav-number">1.</span> <span class="nav-text"><a href="#CCD&#x77E5;&#x8BC6;&#x70B9;" class="headerlink" title="CCD&#x77E5;&#x8BC6;&#x70B9;"></a>CCD&#x77E5;&#x8BC6;&#x70B9;</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#像素-pixel-and-分辨率-resolution"><span class="nav-number">1.1.</span> <span class="nav-text"><a href="#&#x50CF;&#x7D20;-pixel-and-&#x5206;&#x8FA8;&#x7387;-resolution" class="headerlink" title="&#x50CF;&#x7D20; pixel and &#x5206;&#x8FA8;&#x7387; resolution"></a>&#x50CF;&#x7D20; pixel and &#x5206;&#x8FA8;&#x7387; resolution</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#charge"><span class="nav-number">1.2.</span> <span class="nav-text"><a href="#charge" class="headerlink" title="charge"></a>charge</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#degree-arcseconds-arcmin"><span class="nav-number">1.3.</span> <span class="nav-text"><a href="#degree-arcseconds-arcmin" class="headerlink" title="degree arcseconds arcmin"></a>degree arcseconds arcmin</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Some-aspects-of-CCD-behaviour"><span class="nav-number">1.4.</span> <span class="nav-text"><a href="#Some-aspects-of-CCD-behaviour" class="headerlink" title="Some aspects of CCD behaviour"></a>Some aspects of CCD behaviour</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Quantum-Efficiency"><span class="nav-number">1.4.1.</span> <span class="nav-text"><a href="#Quantum-Efficiency" class="headerlink" title="Quantum Efficiency"></a>Quantum Efficiency</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Wavelength-range"><span class="nav-number">1.4.2.</span> <span class="nav-text"><a href="#Wavelength-range" class="headerlink" title="Wavelength range"></a>Wavelength range</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Dynamic-Range"><span class="nav-number">1.4.3.</span> <span class="nav-text"><a href="#Dynamic-Range" class="headerlink" title="Dynamic Range"></a>Dynamic Range</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Linearity"><span class="nav-number">1.4.4.</span> <span class="nav-text"><a href="#Linearity" class="headerlink" title="Linearity"></a>Linearity</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Noise"><span class="nav-number">1.4.5.</span> <span class="nav-text"><a href="#Noise" class="headerlink" title="Noise"></a>Noise</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#full-well-capacity-FWC"><span class="nav-number">1.4.6.</span> <span class="nav-text"><a href="#full-well-capacity-FWC" class="headerlink" title="full-well capacity (FWC)"></a>full-well capacity (FWC)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#System-Gain-G"><span class="nav-number">1.4.7.</span> <span class="nav-text"><a href="#System-Gain-G" class="headerlink" title="System Gain (G)"></a>System Gain (G)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CCD-Format"><span class="nav-number">1.5.</span> <span class="nav-text"><a href="#CCD-Format" class="headerlink" title="CCD Format"></a>CCD Format</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#analog-to-digital-converter-ADC-and-analog-to-digital-unit-ADU"><span class="nav-number">1.5.1.</span> <span class="nav-text"><a href="#analog-to-digital-converter-ADC-and-analog-to-digital-unit-ADU" class="headerlink" title="analog-to-digital converter (ADC) and analog-to-digital unit (ADU)"></a>analog-to-digital converter (ADC) and analog-to-digital unit (ADU)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#image-quality"><span class="nav-number">1.5.2.</span> <span class="nav-text"><a href="#image-quality" class="headerlink" title="image quality"></a>image quality</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#图像矫正"><span class="nav-number">1.6.</span> <span class="nav-text"><a href="#&#x56FE;&#x50CF;&#x77EB;&#x6B63;" class="headerlink" title="&#x56FE;&#x50CF;&#x77EB;&#x6B63;"></a>&#x56FE;&#x50CF;&#x77EB;&#x6B63;</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#暗电流矫正-Dark-current"><span class="nav-number">1.6.1.</span> <span class="nav-text"><a href="#&#x6697;&#x7535;&#x6D41;&#x77EB;&#x6B63;-Dark-current" class="headerlink" title="&#x6697;&#x7535;&#x6D41;&#x77EB;&#x6B63;(Dark current)"></a>&#x6697;&#x7535;&#x6D41;&#x77EB;&#x6B63;(Dark current)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#偏压矫正-bias"><span class="nav-number">1.6.2.</span> <span class="nav-text"><a href="#&#x504F;&#x538B;&#x77EB;&#x6B63;-bias" class="headerlink" title="&#x504F;&#x538B;&#x77EB;&#x6B63;(bias )"></a>&#x504F;&#x538B;&#x77EB;&#x6B63;(bias )</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#平场矫正-flat-field"><span class="nav-number">1.6.3.</span> <span class="nav-text"><a href="#&#x5E73;&#x573A;&#x77EB;&#x6B63;-flat-field" class="headerlink" title="&#x5E73;&#x573A;&#x77EB;&#x6B63;(flat field)"></a>&#x5E73;&#x573A;&#x77EB;&#x6B63;(flat field)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Overscan-区域"><span class="nav-number">1.6.4.</span> <span class="nav-text"><a href="#Overscan-&#x533A;&#x57DF;" class="headerlink" title="Overscan &#x533A;&#x57DF;"></a>Overscan &#x533A;&#x57DF;</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#利用-CCD-进行天文观测的策略"><span class="nav-number">1.7.</span> <span class="nav-text"><a href="#&#x5229;&#x7528;-CCD-&#x8FDB;&#x884C;&#x5929;&#x6587;&#x89C2;&#x6D4B;&#x7684;&#x7B56;&#x7565;" class="headerlink" title="&#x5229;&#x7528; CCD &#x8FDB;&#x884C;&#x5929;&#x6587;&#x89C2;&#x6D4B;&#x7684;&#x7B56;&#x7565;"></a>&#x5229;&#x7528; CCD &#x8FDB;&#x884C;&#x5929;&#x6587;&#x89C2;&#x6D4B;&#x7684;&#x7B56;&#x7565;</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本原理"><span class="nav-number">1.7.1.</span> <span class="nav-text"><a href="#&#x57FA;&#x672C;&#x539F;&#x7406;" class="headerlink" title="&#x57FA;&#x672C;&#x539F;&#x7406;"></a>&#x57FA;&#x672C;&#x539F;&#x7406;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#观测前准备"><span class="nav-number">1.7.2.</span> <span class="nav-text"><a href="#&#x89C2;&#x6D4B;&#x524D;&#x51C6;&#x5907;" class="headerlink" title="&#x89C2;&#x6D4B;&#x524D;&#x51C6;&#x5907;"></a>&#x89C2;&#x6D4B;&#x524D;&#x51C6;&#x5907;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#观测策略"><span class="nav-number">1.7.3.</span> <span class="nav-text"><a href="#&#x89C2;&#x6D4B;&#x7B56;&#x7565;" class="headerlink" title="&#x89C2;&#x6D4B;&#x7B56;&#x7565;"></a>&#x89C2;&#x6D4B;&#x7B56;&#x7565;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#本底图像-BIAS"><span class="nav-number">1.7.4.</span> <span class="nav-text"><a href="#&#x672C;&#x5E95;&#x56FE;&#x50CF;-BIAS" class="headerlink" title="&#x672C;&#x5E95;&#x56FE;&#x50CF;(BIAS)"></a>&#x672C;&#x5E95;&#x56FE;&#x50CF;(BIAS)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#平场-Flat-Field"><span class="nav-number">1.7.5.</span> <span class="nav-text"><a href="#&#x5E73;&#x573A;-Flat-Field" class="headerlink" title="&#x5E73;&#x573A;(Flat-Field)"></a>&#x5E73;&#x573A;(Flat-Field)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#目标源"><span class="nav-number">1.7.6.</span> <span class="nav-text"><a href="#&#x76EE;&#x6807;&#x6E90;" class="headerlink" title="&#x76EE;&#x6807;&#x6E90;"></a>&#x76EE;&#x6807;&#x6E90;</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据处理"><span class="nav-number">1.8.</span> <span class="nav-text"><a href="#&#x6570;&#x636E;&#x5904;&#x7406;" class="headerlink" title="&#x6570;&#x636E;&#x5904;&#x7406;"></a>&#x6570;&#x636E;&#x5904;&#x7406;</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本原理-1"><span class="nav-number">1.8.1.</span> <span class="nav-text"><a href="#&#x57FA;&#x672C;&#x539F;&#x7406;-1" class="headerlink" title="&#x57FA;&#x672C;&#x539F;&#x7406;"></a>&#x57FA;&#x672C;&#x539F;&#x7406;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#成像"><span class="nav-number">1.8.2.</span> <span class="nav-text"><a href="#&#x6210;&#x50CF;" class="headerlink" title="&#x6210;&#x50CF;"></a>&#x6210;&#x50CF;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#光谱"><span class="nav-number">1.8.3.</span> <span class="nav-text"><a href="#&#x5149;&#x8C31;" class="headerlink" title="&#x5149;&#x8C31;"></a>&#x5149;&#x8C31;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#误差"><span class="nav-number">1.8.4.</span> <span class="nav-text"><a href="#&#x8BEF;&#x5DEE;" class="headerlink" title="&#x8BEF;&#x5DEE;"></a>&#x8BEF;&#x5DEE;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CCD-增益和读出噪声计算"><span class="nav-number">1.8.5.</span> <span class="nav-text"><a href="#CCD-&#x589E;&#x76CA;&#x548C;&#x8BFB;&#x51FA;&#x566A;&#x58F0;&#x8BA1;&#x7B97;" class="headerlink" title="CCD &#x589E;&#x76CA;&#x548C;&#x8BFB;&#x51FA;&#x566A;&#x58F0;&#x8BA1;&#x7B97;"></a>CCD &#x589E;&#x76CA;&#x548C;&#x8BFB;&#x51FA;&#x566A;&#x58F0;&#x8BA1;&#x7B97;</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#图像合并"><span class="nav-number">1.9.</span> <span class="nav-text"><a href="#&#x56FE;&#x50CF;&#x5408;&#x5E76;" class="headerlink" title="&#x56FE;&#x50CF;&#x5408;&#x5E76;"></a>&#x56FE;&#x50CF;&#x5408;&#x5E76;</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#图像处理流程详细知识"><span class="nav-number">1.10.</span> <span class="nav-text"><a href="#&#x56FE;&#x50CF;&#x5904;&#x7406;&#x6D41;&#x7A0B;&#x8BE6;&#x7EC6;&#x77E5;&#x8BC6;" class="headerlink" title="&#x56FE;&#x50CF;&#x5904;&#x7406;&#x6D41;&#x7A0B;&#x8BE6;&#x7EC6;&#x77E5;&#x8BC6;"></a>&#x56FE;&#x50CF;&#x5904;&#x7406;&#x6D41;&#x7A0B;&#x8BE6;&#x7EC6;&#x77E5;&#x8BC6;</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#天光背景知识与提取-SEXtractor"><span class="nav-number">1.10.1.</span> <span class="nav-text"><a href="#&#x5929;&#x5149;&#x80CC;&#x666F;&#x77E5;&#x8BC6;&#x4E0E;&#x63D0;&#x53D6;-SEXtractor" class="headerlink" title="&#x5929;&#x5149;&#x80CC;&#x666F;&#x77E5;&#x8BC6;&#x4E0E;&#x63D0;&#x53D6; SEXtractor"></a>&#x5929;&#x5149;&#x80CC;&#x666F;&#x77E5;&#x8BC6;&#x4E0E;&#x63D0;&#x53D6; SEXtractor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#目标源的检测"><span class="nav-number">1.10.2.</span> <span class="nav-text"><a href="#&#x76EE;&#x6807;&#x6E90;&#x7684;&#x68C0;&#x6D4B;" class="headerlink" title="&#x76EE;&#x6807;&#x6E90;&#x7684;&#x68C0;&#x6D4B;"></a>&#x76EE;&#x6807;&#x6E90;&#x7684;&#x68C0;&#x6D4B;</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2018-10-01</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">BQGao</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">9.2k</span>
  
</div>

<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>





        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  

    
      <script id="dsq-count-scr" src="https://.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://yoursite.com/2017/07/10/CCD知识点/';
          this.page.identifier = '2017/07/10/CCD知识点/';
          this.page.title = 'CCD知识点';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>